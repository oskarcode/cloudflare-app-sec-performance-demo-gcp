{% extends 'shop/base.html' %}

{% block title %}Git Secrets Exposed - Security Demo{% endblock %}

{% block content %}
<div class="container mt-5">
    <div class="row">
        <div class="col-md-12">
            <div class="alert alert-danger" role="alert">
                <h4 class="alert-heading">‚ö†Ô∏è SECURITY VULNERABILITY DETECTED!</h4>
                <p><strong>This page intentionally exposes sensitive information for Cloudflare WAF testing purposes.</strong></p>
                <p>In a real application, this would be a critical security vulnerability that should be blocked by Cloudflare's managed rules.</p>
                <hr>
                <p class="mb-0">If you can see this page, Cloudflare's security rules may need adjustment.</p>
            </div>

            <h2>üîì Exposed Git Secrets</h2>
            <p class="text-muted">The following sensitive information should never be exposed in production:</p>

            <div class="card mt-4">
                <div class="card-header bg-danger text-white">
                    <h5>üö® Sensitive Credentials Found</h5>
                </div>
                <div class="card-body">
                    <div class="row">
                        {% for key, value in secrets.items %}
                        <div class="col-md-6 mb-3">
                            <div class="card border-danger">
                                <div class="card-header bg-light">
                                    <strong>{{ key|upper }}</strong>
                                </div>
                                <div class="card-body">
                                    <code class="text-danger">{{ value }}</code>
                                </div>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                </div>
            </div>

            <div class="card mt-4">
                <div class="card-header bg-warning">
                    <h5>üõ°Ô∏è Cloudflare WAF Testing</h5>
                </div>
                <div class="card-body">
                    <p>This endpoint is designed to test Cloudflare's managed rules that should block:</p>
                    <ul>
                        <li><strong>Git Secrets Detection</strong> - Patterns like API keys, passwords, tokens</li>
                        <li><strong>Sensitive Data Exposure</strong> - Database credentials, encryption keys</li>
                        <li><strong>Configuration Files</strong> - Environment variables, secrets</li>
                    </ul>
                    
                    <div class="alert alert-info mt-3">
                        <strong>Expected Behavior:</strong> Cloudflare should block access to this page and return a security challenge or block page.
                    </div>
                </div>
            </div>

            <div class="mt-4">
                <a href="{% url 'home' %}" class="btn btn-primary">‚Üê Back to Home</a>
                <a href="{% url 'presentation' %}" class="btn btn-secondary">View Security Presentation</a>
            </div>
        </div>
    </div>
</div>

<style>
.card {
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

.alert {
    border-radius: 8px;
}

code {
    word-break: break-all;
    font-size: 0.9em;
}
</style>
{% endblock %}
